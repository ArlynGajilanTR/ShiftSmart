# ShiftSmart Project Rules

## Supabase Database (CRITICAL)
- **USE:** ShiftSmart-v2 (project_id: `wmozxwlmdyxdnzcxetgl`, region: us-west-2)
- **DO NOT USE:** Old project `lxjybduwccqurazhibau` (INACTIVE/paused)
- URL: `https://wmozxwlmdyxdnzcxetgl.supabase.co`
- When using MCP Supabase tools, always target project `wmozxwlmdyxdnzcxetgl`

## Test Credentials
- Admin: `arlyn.gajilan@thomsonreuters.com` / password: `testtest`
- All other users: password `changeme`
- bcrypt hash for `changeme`: `$2a$10$uXoJ.lZEy7GquXNml8sW0O9xUNlPCBF0eqrEA0/FLJepOYzWCEhB.`

## Designated Team Leaders
- `arlyn.gajilan@thomsonreuters.com` (Arlyn Gajilan) - Admin + Team Leader
- `sabina.suzzi@thomsonreuters.com` (Sabina Suzzi) - Team Leader
- `gianluca.semeraro@thomsonreuters.com` (Gianluca Semeraro) - Team Leader
- Team leaders have `is_team_leader = true` in the database
- Team leader permissions: confirm preferences, generate schedules, manage employees

## Critical: role vs shift_role
- `role` = System permissions (admin/manager/scheduler/staff)
- `shift_role` = Editorial role for scheduling (editor/senior/correspondent)
- These are BOTH required and serve different purposes. Never consolidate them.

## Auth: Custom implementation
- This project uses custom session-based auth, NOT Supabase Auth
- Tokens use `Authorization: Bearer <token>` header
- Password field is `password_hash` (bcrypt via bcryptjs)
- Session tokens stored in `users` table (session_token, session_expires_at columns)

## API Response Mapping
- API returns `name` (from DB `full_name`)
- API returns `role` (from DB `title` - editorial position)
- Don't confuse API `role` with DB `role` (system permissions)

## Libraries & Conventions
- Dates: use `date-fns`, not moment.js or native Date
- All timestamps use `TIMESTAMP WITH TIME ZONE`
- Default timezone: `America/New_York`

## AI Integration
- Uses Anthropic Claude (ANTHROPIC_API_KEY), not OpenAI
- Prompts centralized in `/lib/ai/prompts/`

## Reference
- Full gotchas: `docs/PROJECT_FIELD_GOTCHAS.md`
- Schema: `supabase/schema.sql`
